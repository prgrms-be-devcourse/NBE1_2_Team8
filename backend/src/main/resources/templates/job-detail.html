<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>채용 공고 상세 조회</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container mt-5">
  <h2 class="mb-4">채용 공고 상세 정보</h2>
  <div id="jobDetail" class="card">
    <div class="card-header">
      <h3 id="job_post_name">채용 공고 이름</h3>
      <small>회사: <span id="company_name">회사 이름</span></small>
    </div>
    <div class="card-body">
      <p><strong>회사 주소:</strong> <span id="company_address">회사 주소</span></p>
      <p><strong>회사 링크:</strong> <a id="company_link" href="#">링크</a></p>
      <p><strong>공고 시작일:</strong> <span id="open_date">시작일</span></p>
      <p><strong>공고 마감일:</strong> <span id="end_date">마감일</span></p>
      <p><strong>급여:</strong> <span id="salary">급여</span></p>
      <p><strong>상태:</strong> <span id="status">상태</span></p>
      <p><strong>조회수:</strong> <span id="views">조회수</span></p>
      <p><strong>좋아요 수:</strong> <span id="likes">좋아요</span></p>
      <h5>기술 스택</h5>
      <ul id="tech_stack_list" class="list-group"></ul> <!-- 기술 스택 목록을 표시할 영역 -->
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
  const jobPostId = window.location.pathname.split('/').pop(); // URL에서 jobPostId 추출

  // 채용 공고 상세 정보를 가져오는 함수
  async function fetchJobPostDetail() {
    try {
      const response = await axios.get(`/api/v1/job-posts/${jobPostId}`);
      const jobPost = response.data;

      // Snake Case 데이터를 반영하여 HTML 요소에 값 설정
      document.getElementById('job_post_name').innerText = jobPost.job_post_name;
      document.getElementById('company_name').innerText = jobPost.company_name;
      document.getElementById('company_address').innerText = jobPost.company_address;
      document.getElementById('company_link').setAttribute('href', jobPost.company_link);
      document.getElementById('company_link').innerText = jobPost.company_link;
      document.getElementById('open_date').innerText = new Date(jobPost.open_date).toLocaleDateString();
      document.getElementById('end_date').innerText = new Date(jobPost.end_date).toLocaleDateString();
      document.getElementById('salary').innerText = jobPost.salary;
      document.getElementById('status').innerText = jobPost.status;
      document.getElementById('views').innerText = jobPost.views;
      document.getElementById('likes').innerText = jobPost.likes;

      // 기술 스택 목록 업데이트
      const techStackList = document.getElementById('tech_stack_list');
      techStackList.innerHTML = ''; // 기존 목록 초기화

      jobPost.tech_stacks.forEach(stack => {
        const listItem = document.createElement('li');
        listItem.className = 'list-group-item';
        listItem.innerHTML = `
          <strong>${stack.name}</strong>
        `;
        techStackList.appendChild(listItem);
      });
    } catch (error) {
      console.error('채용 공고 정보를 가져오는 중 오류가 발생했습니다.', error);
    }
  }

  // 페이지 로드 시 채용 공고 상세 정보를 가져옴
  fetchJobPostDetail();
</script>
</body>
</html>
